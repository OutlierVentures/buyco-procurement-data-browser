splitrows col: column1 on: '\r\n'
split col: column1 on: ',' limit: 6 quote: '\"'
header
union with: june_2016_data_to_publish, june_2015_data_to_publish, june_2014_data_to_publish, june_2013_data_to_publish, june_2012_data_to_publish, june_2011_data_to_publish, july_2016_data_to_publish, july_2015_data_to_publish, july_2014_data_to_publish, july_2013_data_to_publish, july_2012_data_to_publish, july_2011_data_to_publish, january_2016_data_to_publish, january_2015_data_to_publish, january_2014_data_to_publish, january_2013_data_to_publish, january_2012_data_to_publish, january_2011_data_to_publish, february_2016_data_to_publish, february_2015_data_to_publish, february_2014_data_to_publish, february_2013_data_to_publish, february_2012_data_to_publish, february_2011_data_to_publish, december_2016_data_to_publish, december_2015_data_to_publish, december_2013_data_to_publish, december_2014_data_to_publish, december_2012_data_to_publish, december_2011_data_to_publish, december_2010_data_to_publish, august_2016_data_to_publish, august_2015_data_to_publish, august_2014_data_to_publish, august_2013_data_to_publish, august_2012_data_to_publish, august_2011_data_to_publish, april_2016_data_to_publish, april_2015_data_to_publish, april_2014_data_to_publish, april_2013_data_to_publish mapping: {'as': 'Body_Name', 'sources': current_dataset.Body_Name, june_2016_data_to_publish.BODY, june_2015_data_to_publish.Body, june_2014_data_to_publish.BODY, june_2013_data_to_publish.BODY, june_2012_data_to_publish.Company, june_2011_data_to_publish.Body_Name, july_2016_data_to_publish.BODY, july_2015_data_to_publish.BODY, july_2014_data_to_publish.BODY, july_2013_data_to_publish.BODY, july_2012_data_to_publish.Body, july_2011_data_to_publish.Body_Name, january_2016_data_to_publish.Body, january_2015_data_to_publish.BODY, january_2014_data_to_publish.BODY, january_2013_data_to_publish.BODY, january_2012_data_to_publish.Body_Name, january_2011_data_to_publish.Body_Name, february_2016_data_to_publish.Body, february_2015_data_to_publish.BODY, february_2014_data_to_publish.BODY, february_2013_data_to_publish.BODY, february_2012_data_to_publish.Body_Name, february_2011_data_to_publish.Body_Name, december_2016_data_to_publish.BODY, december_2015_data_to_publish.BODY, december_2013_data_to_publish.BODY, december_2014_data_to_publish.BODY, december_2012_data_to_publish.BODY, december_2011_data_to_publish.Body_Name, december_2010_data_to_publish.Body_Name, august_2016_data_to_publish.Body, august_2015_data_to_publish.Body, august_2014_data_to_publish.BODY, august_2013_data_to_publish.BODY, august_2012_data_to_publish.Body, august_2011_data_to_publish.Body_Name, april_2016_data_to_publish.Body, april_2015_data_to_publish.BODY, april_2014_data_to_publish.BODY, april_2013_data_to_publish.BODY}, {'as': 'Date', 'sources': current_dataset.Date, june_2016_data_to_publish.Date, june_2015_data_to_publish.Date, june_2014_data_to_publish.Date, june_2013_data_to_publish.Date, june_2012_data_to_publish.Paid_Date, june_2011_data_to_publish.Date, july_2016_data_to_publish.Date, july_2015_data_to_publish.Date, july_2014_data_to_publish.Date, july_2013_data_to_publish.Date, july_2012_data_to_publish.Date, july_2011_data_to_publish.Date, january_2016_data_to_publish.Date, january_2015_data_to_publish.Date, january_2014_data_to_publish.Date, january_2013_data_to_publish.Date, january_2012_data_to_publish.Date, january_2011_data_to_publish.Date, february_2016_data_to_publish.Date, february_2015_data_to_publish.Date, february_2014_data_to_publish.Date, february_2013_data_to_publish.Date, february_2012_data_to_publish.Date, february_2011_data_to_publish.Date, december_2016_data_to_publish.DATE, december_2015_data_to_publish.Date, december_2013_data_to_publish.Date, december_2014_data_to_publish.Date, december_2012_data_to_publish.Date, december_2011_data_to_publish.Date, december_2010_data_to_publish.Date, august_2016_data_to_publish.Date, august_2015_data_to_publish.Date, august_2014_data_to_publish.Date, august_2013_data_to_publish.Date, august_2012_data_to_publish.Date, august_2011_data_to_publish.Date, april_2016_data_to_publish.Date, april_2015_data_to_publish.Date, april_2014_data_to_publish.Date, april_2013_data_to_publish.Date}, {'as': 'Amount', 'sources': current_dataset.Amount, june_2016_data_to_publish.Amount, june_2015_data_to_publish.Line_Value, june_2014_data_to_publish.Line_Value, june_2013_data_to_publish.Amount, june_2012_data_to_publish.Line_Value, june_2011_data_to_publish.Amount, july_2016_data_to_publish.Amount, july_2015_data_to_publish.Line_Value, july_2014_data_to_publish.Line_Value, july_2013_data_to_publish.Amount, july_2012_data_to_publish.Amount, july_2011_data_to_publish.Amount, january_2016_data_to_publish.Line_Value, january_2015_data_to_publish.Line_Value, january_2014_data_to_publish.Line_Value, january_2013_data_to_publish.Amount, january_2012_data_to_publish.Amount, january_2011_data_to_publish.Amount, february_2016_data_to_publish.Line_Value, february_2015_data_to_publish.Line_Value, february_2014_data_to_publish.Line_Value, february_2013_data_to_publish.Amount, february_2012_data_to_publish.Amount, february_2011_data_to_publish.Amount, december_2016_data_to_publish.AMOUNT, december_2015_data_to_publish.Line_Value, december_2013_data_to_publish.Amount, december_2014_data_to_publish.Line_Value, december_2012_data_to_publish.Amount, december_2011_data_to_publish.Amount, december_2010_data_to_publish.Amount, august_2016_data_to_publish.Amount, august_2015_data_to_publish.Line_Value, august_2014_data_to_publish.Line_Value, august_2013_data_to_publish.Amount, august_2012_data_to_publish.Amount, august_2011_data_to_publish.Amount, april_2016_data_to_publish.Amount, april_2015_data_to_publish.Line_Value, april_2014_data_to_publish.Line_Value, april_2013_data_to_publish.Amount}, {'as': 'Supplier', 'sources': current_dataset.Supplier, june_2016_data_to_publish.Supplier_Name, june_2015_data_to_publish.Supplier, june_2014_data_to_publish.Supplier, june_2013_data_to_publish.Supplier, june_2012_data_to_publish.Supplier_Name, june_2011_data_to_publish.Supplier, july_2016_data_to_publish.Supplier_Name, july_2015_data_to_publish.Supplier, july_2014_data_to_publish.Supplier, july_2013_data_to_publish.Supplier, july_2012_data_to_publish.Supplier, july_2011_data_to_publish.Supplier, january_2016_data_to_publish.Supplier, january_2015_data_to_publish.Supplier, january_2014_data_to_publish.Supplier, january_2013_data_to_publish.Supplier, january_2012_data_to_publish.Supplier, january_2011_data_to_publish.Supplier, february_2016_data_to_publish.Supplier_Name, february_2015_data_to_publish.Supplier, february_2014_data_to_publish.Supplier, february_2013_data_to_publish.Supplier, february_2012_data_to_publish.Supplier, february_2011_data_to_publish.Supplier, december_2016_data_to_publish.SUPPLIER, december_2015_data_to_publish.Supplier, december_2013_data_to_publish.Supplier, december_2014_data_to_publish.Supplier, december_2012_data_to_publish.Supplier, december_2011_data_to_publish.Supplier, december_2010_data_to_publish.Supplier, august_2016_data_to_publish.Supplier, august_2015_data_to_publish.Supplier, august_2014_data_to_publish.Supplier, august_2013_data_to_publish.Supplier, august_2012_data_to_publish.Supplier, august_2011_data_to_publish.Supplier, april_2016_data_to_publish.Supplier_Name, april_2015_data_to_publish.Supplier, april_2014_data_to_publish.Supplier, april_2013_data_to_publish.Supplier}, {'as': 'Expense_Area', 'sources': current_dataset.Expense_Area, june_2016_data_to_publish.Expense_Area, june_2015_data_to_publish.Expense_Area, june_2014_data_to_publish.Expense_Area, june_2013_data_to_publish.Expense_Area, june_2012_data_to_publish.Expense_Area, june_2011_data_to_publish.Expense_Area, july_2016_data_to_publish.Expense_Area, july_2015_data_to_publish.Expense_Area, july_2014_data_to_publish.Expense_Area, july_2013_data_to_publish.Expense_Area, july_2012_data_to_publish.Expense_Area, july_2011_data_to_publish.Expense_Area, january_2016_data_to_publish.Expense_Area, january_2015_data_to_publish.Expense_Area, january_2014_data_to_publish.Expense_Area, january_2013_data_to_publish.Expense_Area, january_2012_data_to_publish.Expense_Area, january_2011_data_to_publish.Expense_Area, february_2016_data_to_publish.Expense_Area, february_2015_data_to_publish.Expense_Area, february_2014_data_to_publish.Expense_Area, february_2013_data_to_publish.Expense_Area, february_2012_data_to_publish.Expense_Area, february_2011_data_to_publish.Expense_Area, december_2016_data_to_publish.EXPENSE_AREA, december_2015_data_to_publish.Expense_Area, december_2013_data_to_publish.Expense_Area, december_2014_data_to_publish.Expense_Area, december_2012_data_to_publish.Expense_Area, december_2011_data_to_publish.Expense_Area, december_2010_data_to_publish.Expense_Area, august_2016_data_to_publish.Expense_Area, august_2015_data_to_publish.Expense_Area, august_2014_data_to_publish.Expense_Area, august_2013_data_to_publish.Expense_Area, august_2012_data_to_publish.Expense_Area, august_2011_data_to_publish.Expense_Area, april_2016_data_to_publish.Expense_Area, april_2015_data_to_publish.Expense_Area, april_2014_data_to_publish.Expense_Area, april_2013_data_to_publish.Expense_Area}, {'as': 'Expense_Type', 'sources': current_dataset.Expense_Type, june_2016_data_to_publish.Expense_Type, june_2015_data_to_publish.Expense_type, june_2014_data_to_publish.Expense_Type, june_2013_data_to_publish.Expense_Type, june_2012_data_to_publish.Expense_Type, june_2011_data_to_publish.Expense_Type, july_2016_data_to_publish.Expense_Type, july_2015_data_to_publish.Expense_Type, july_2014_data_to_publish.Expense_Type, july_2013_data_to_publish.Expense_Type, july_2012_data_to_publish.Expense_Type, null(), january_2016_data_to_publish.Expense_Type, january_2015_data_to_publish.Expense_Type, january_2014_data_to_publish.Expense_Type, january_2013_data_to_publish.Expense_Type, null(), january_2011_data_to_publish.Expense_Type, february_2016_data_to_publish.Expense_Type, february_2015_data_to_publish.Expense_Type, february_2014_data_to_publish.Expense_Type, february_2013_data_to_publish.Expense_Type, null(), february_2011_data_to_publish.Expense_Type, december_2016_data_to_publish.EXPENSE_TYPE, december_2015_data_to_publish.Expense_Type, december_2013_data_to_publish.Expense_Type, december_2014_data_to_publish.Expense_Type, december_2012_data_to_publish.Expense_Type, null(), december_2010_data_to_publish.Expense_Type, august_2016_data_to_publish.Expense_Type, august_2015_data_to_publish.Expense_Type, august_2014_data_to_publish.Expense_Type, august_2013_data_to_publish.Expense_Type, august_2012_data_to_publish.Expense_Type, null(), april_2016_data_to_publish.Expense_Type, april_2015_data_to_publish.Expense_Type, april_2014_data_to_publish.Expense_Type, april_2013_data_to_publish.Expense_Type}
rename col: Body_Name to: 'organisation_name'
set col: organisation_name value: 'Rotherham Council'
derive value: '' as: 'organisation_code'
rename col: Date to: 'payment_date'
derive value: if(ismismatched(payment_date, ['Datetime','dd-mm-yy','dd*mm*yyyy']), payment_date, '') as: 'missmatched_date'
derive value: (missmatched_date - 25569) * 86400000 as: 'column1'
settype col: column1 type: 'Integer'
set col: column1 value: unixtimeformat(column1, 'dd\/MM\/yyyy')
set col: payment_date value: ifmismatched($col, ['Datetime','dd-mm-yy','dd*mm*yyyy'], column1)
drop col: missmatched_date
drop col: column1
derive value: payment_date as: 'effective_date'
rename col: Amount to: 'amount_net'
rename col: Supplier to: 'supplier_name'
rename col: Expense_Area to: 'sercop_service'
rename col: Expense_Type to: 'procurement_classification_1'
derive value: '' as: 'purpose_of_spend_1'
replace col: procurement_classification_1 with: '' on: '\"' global: true
replace col: sercop_service with: '' on: '\"' global: true
replace col: supplier_name with: '' on: '\"' global: true