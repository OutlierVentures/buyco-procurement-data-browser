splitrows col: column1 on: '\r\n' quote: '\"'
split col: column1 on: ',' limit: 6 quote: '\"'
header
union with: spend_over_500_-_march_2017, spend_over_500_-_january_2017, spend_over_500_-_february_2017, september_2016_data_to_publish, september_2015_data_to_publish, september_2014_data_to_publish, september_2013_data_to_publish, september_2011_data_to_publish, october_2016_data_to_publish, october_2015_data_to_publish, october_2014_data_to_publish, october_2013_data_to_publish, october_2012_data_to_publish, october_2010_data_to_publish, november_2016_data_to_publish, november_2015_data_to_publish, november_2014_data_to_publish, november_2013_data_to_publish, november_2012_data_to_publish, november_2010_data_to_publish, may_2016_data_to_publish, may_2014_data_to_publish, may_2012_data_to_publish, may_2011_data_to_publish, march_2016_data_to_publish, march_2015_data_to_publish, march_2014_data_to_publish, march_2013_data_to_publish, march_2011_data_to_publish mapping: {'as': 'BODY', 'sources': current_dataset.BODY, spend_over_500_-_march_2017.BODY, spend_over_500_-_january_2017.Body, spend_over_500_-_february_2017.BODY, september_2016_data_to_publish.Body, september_2015_data_to_publish.Body, september_2014_data_to_publish.BODY, september_2013_data_to_publish.BODY, september_2011_data_to_publish.Body_Name, october_2016_data_to_publish.Body, october_2015_data_to_publish.Body, october_2014_data_to_publish.BODY, october_2013_data_to_publish.BODY, october_2012_data_to_publish.Company, october_2010_data_to_publish.Body, november_2016_data_to_publish.Sysref, november_2015_data_to_publish.Body, november_2014_data_to_publish.BODY, november_2013_data_to_publish.BODY, november_2012_data_to_publish.Body, november_2010_data_to_publish.Body_Name, may_2016_data_to_publish.BODY, may_2014_data_to_publish.BODY, may_2012_data_to_publish.Body, may_2011_data_to_publish.Body_Name, march_2016_data_to_publish.Body, march_2015_data_to_publish.BODY, march_2014_data_to_publish.BODY, march_2013_data_to_publish.BODY, march_2011_data_to_publish.Body_Name}, {'as': 'Date', 'sources': current_dataset.Date, spend_over_500_-_march_2017.DATE, spend_over_500_-_january_2017.Date, spend_over_500_-_february_2017.DATE, september_2016_data_to_publish.Date, september_2015_data_to_publish.Date, september_2014_data_to_publish.Date, september_2013_data_to_publish.Date, september_2011_data_to_publish.Date, october_2016_data_to_publish.Date, october_2015_data_to_publish.Date, october_2014_data_to_publish.Date, october_2013_data_to_publish.Date, october_2012_data_to_publish.Paid_Date, october_2010_data_to_publish.DATE, november_2016_data_to_publish.Date, november_2015_data_to_publish.Date, november_2014_data_to_publish.Date, november_2013_data_to_publish.Date, november_2012_data_to_publish.Date, november_2010_data_to_publish.Date, may_2016_data_to_publish.Date, may_2014_data_to_publish.Date, may_2012_data_to_publish.Paid_Date, may_2011_data_to_publish.Date, march_2016_data_to_publish.Date, march_2015_data_to_publish.Date, march_2014_data_to_publish.Date, march_2013_data_to_publish.Date, march_2011_data_to_publish.Date}, {'as': 'Amount', 'sources': current_dataset.Amount, spend_over_500_-_march_2017.AMOUNT, spend_over_500_-_january_2017.Amount, spend_over_500_-_february_2017.AMOUNT, september_2016_data_to_publish.Amount, september_2015_data_to_publish.Line_Value, september_2014_data_to_publish.Line_Value, september_2013_data_to_publish.Amount, september_2011_data_to_publish.Amount, october_2016_data_to_publish.Amount, october_2015_data_to_publish.Line_Value, october_2014_data_to_publish.Line_Value, october_2013_data_to_publish.Amount, october_2012_data_to_publish.Line_Value, october_2010_data_to_publish.Amount, november_2016_data_to_publish.Amount, november_2015_data_to_publish.Line_Value, november_2014_data_to_publish.Line_Value, november_2013_data_to_publish.Amount, november_2012_data_to_publish.Amount, november_2010_data_to_publish.Amount, may_2016_data_to_publish.AMOUNT, may_2014_data_to_publish.Line_Value, may_2012_data_to_publish.Line_Value, may_2011_data_to_publish.Amount, march_2016_data_to_publish.Line_Value, march_2015_data_to_publish.Line_Value, march_2014_data_to_publish.Line_Value, march_2013_data_to_publish.Amount, march_2011_data_to_publish.Amount}, {'as': 'Supplier', 'sources': current_dataset.Supplier, spend_over_500_-_march_2017.SUPPLIER, spend_over_500_-_january_2017.Supplier, spend_over_500_-_february_2017.SUPPLIER, september_2016_data_to_publish.Supplier_Name, september_2015_data_to_publish.Supplier, september_2014_data_to_publish.Supplier, september_2013_data_to_publish.Supplier, september_2011_data_to_publish.Supplier, october_2016_data_to_publish.Supplier_Name, october_2015_data_to_publish.Supplier, october_2014_data_to_publish.Supplier, october_2013_data_to_publish.Supplier, october_2012_data_to_publish.Supplier, october_2010_data_to_publish.Supplier, november_2016_data_to_publish.Supplier_Name, november_2015_data_to_publish.Supplier, november_2014_data_to_publish.Supplier, november_2013_data_to_publish.Supplier, november_2012_data_to_publish.Supplier, november_2010_data_to_publish.Supplier, may_2016_data_to_publish.SUPPLIER_NAME, may_2014_data_to_publish.Supplier, may_2012_data_to_publish.Supplier, may_2011_data_to_publish.Supplier, march_2016_data_to_publish.Supplier, march_2015_data_to_publish.Supplier, march_2014_data_to_publish.Supplier, march_2013_data_to_publish.Supplier, march_2011_data_to_publish.Supplier}, {'as': 'Expense_Area', 'sources': current_dataset.Expense_Area, spend_over_500_-_march_2017.EXPENSE_AREA, spend_over_500_-_january_2017.Expense_Area, spend_over_500_-_february_2017.EXPENSE_AREA, september_2016_data_to_publish.Expense_Area, september_2015_data_to_publish.Expense_Area, september_2014_data_to_publish.Expense_Area, september_2013_data_to_publish.Expense_Area, september_2011_data_to_publish.Expense_Area, october_2016_data_to_publish.Expense_Area, october_2015_data_to_publish.Expense_Area, october_2014_data_to_publish.Expense_Area, october_2013_data_to_publish.Expense_Area, october_2012_data_to_publish.Expense_Area, october_2010_data_to_publish.Expense_Area, november_2016_data_to_publish.Expense_Area, november_2015_data_to_publish.Expense_Area, november_2014_data_to_publish.Expense_Area, november_2013_data_to_publish.Expense_Area, november_2012_data_to_publish.Expense_Area, november_2010_data_to_publish.Expense_Area, may_2016_data_to_publish.EXPENSE_AREA, may_2014_data_to_publish.Expense_Area, may_2012_data_to_publish.Expense_Area, may_2011_data_to_publish.Expense_Area, march_2016_data_to_publish.Expense_Area, march_2015_data_to_publish.Expense_Area, march_2014_data_to_publish.Expense_Area, march_2013_data_to_publish.Expense_Area, march_2011_data_to_publish.Expense_Area}, {'as': 'Expense_Type', 'sources': current_dataset.Expense_Type, spend_over_500_-_march_2017.EXPENSE_TYPE, spend_over_500_-_january_2017.Expense_Type, spend_over_500_-_february_2017.EXPENSE_TYPE, september_2016_data_to_publish.Expense_Type, september_2015_data_to_publish.Expense_Type, september_2014_data_to_publish.Expense_Type, september_2013_data_to_publish.Expense_Type, null(), october_2016_data_to_publish.Expense_Type, october_2015_data_to_publish.Expense_Type, october_2014_data_to_publish.Expense_Type, october_2013_data_to_publish.Expense_Type, october_2012_data_to_publish.EXPENSE_TYPE, october_2010_data_to_publish.Expense_Type, november_2016_data_to_publish.Expense_Type, november_2015_data_to_publish.Expense_Type, november_2014_data_to_publish.Expense_Type, november_2013_data_to_publish.Expense_Type, november_2012_data_to_publish.Expense_Type, november_2010_data_to_publish.Expense_Type, may_2016_data_to_publish.EXPENSE_TYPE, may_2014_data_to_publish.Expense_Type, null(), may_2011_data_to_publish.Expense_Type, march_2016_data_to_publish.Expense_Type, march_2015_data_to_publish.Expense_Type, march_2014_data_to_publish.Expense_Type, march_2013_data_to_publish.Expense_Type, march_2011_data_to_publish.Expense_Type}
rename col: BODY to: 'organisation_name'
set col: organisation_name value: 'Rotherham Council'
derive value: '' as: 'organisation_code'
rename col: Date to: 'payment_date'
rename col: Amount to: 'amount_net'
rename col: Supplier to: 'supplier_name'
rename col: Expense_Area to: 'sercop_service'
rename col: Expense_Type to: 'procurement_classification_1'
replace col: procurement_classification_1 with: '' on: '\"' global: true
replace col: sercop_service with: '' on: '\"' global: true
replace col: supplier_name with: '' on: '\"' global: true
derive value: if(ismismatched(payment_date, ['Datetime','dd-mm-yy','dd*mm*yyyy']), payment_date, '') as: 'missmatched_date'
derive value: (missmatched_date - 25569) * 86400000 as: 'column1'
settype col: column1 type: 'Integer'
set col: column1 value: unixtimeformat(column1, 'dd\/MM\/yyyy')
set col: payment_date value: ifmismatched($col, ['Datetime','dd-mm-yy','dd*mm*yyyy'], column1)
drop col: missmatched_date
drop col: column1
derive value: payment_date as: 'effective_date'
derive value: '' as: 'purpose_of_spend_1'